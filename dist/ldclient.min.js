!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.LDClient=t():e.LDClient=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function r(e){m.enqueue({kind:"identify",key:e.key,user:e,creationDate:(new Date).getTime()})}function o(e,t,n){var r=E.getUser(),o=JSON.stringify(t)+(r&&r.key?r.key:"")+e,i=new Date,a=B[o];a&&i-a<3e5||(B[o]=i,m.enqueue({kind:"feature",key:e,user:r,value:t,"default":n,creationDate:i.getTime()}))}function i(e,t){var n={kind:e,key:t.key,data:null,url:window.location.href,creationDate:(new Date).getTime()};return"click"===e&&(n.selector=t.selector),m.enqueue(n)}function a(e,t,n){E.setUser(e),w.fetchFlagSettings(E.getUser(),t,function(e,t){t&&f(t),n&&n()})}function c(e,t){var n;return n=I&&I.hasOwnProperty(e)?null===I[e]?t:I[e]:t,o(e,n,t),n}function s(){var e={};if(!I)return e;for(var t in I)I.hasOwnProperty(t)&&(e[t]=c(t,null));return e}function u(e,t){if("string"!=typeof e)throw"Event key must be a string";m.enqueue({kind:"custom",key:e,data:t,url:window.location.href,creationDate:(new Date).getTime()})}function l(){k.connect(function(){w.fetchFlagSettings(E.getUser(),S,function(e,t){f(t)})})}function f(e){var t,n;e&&(t=q.modifications(I,e),n=Object.keys(t),I=e,T&&localStorage.setItem(h(y,E.getUser()),JSON.stringify(I)),n.length>0&&(n.forEach(function(e){b.emit(G+":"+e,t[e].current,t[e].previous)}),b.emit(G,t),n.forEach(function(e){o(e,t[e].current)})))}function p(e,t,n){e.substr(0,G.length)===G?(k.isConnected()||l(),b.on.apply(b,[e,t,n])):b.on.apply(b,Array.prototype.slice.call(arguments))}function d(){b.off.apply(b,Array.prototype.slice.call(arguments))}function g(e){if(e.origin===x&&"SYN"===e.data.type){window.editorClientBaseUrl=x;var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=x+e.data.editorClientUrl;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}}function h(e,t){var n="";return t&&t.key&&(n=t.key),"ld:"+e+":"+n}function v(e,t,n){function o(){setTimeout(function e(){m.flush(E.getUser()),setTimeout(e,$)},$)}function a(){O&&O.dispose(),N&&N.length&&(O=D(N,i))}var c;if(n=n||{},y=e,I="object"==typeof n.bootstrap?n.bootstrap:{},S=n.hash,x=n.baseUrl||"https://app.launchdarkly.com",U=n.eventsUrl||"https://events.launchdarkly.com",L=n.streamUrl||"https://clientstream.launchdarkly.com",k=J(L,y),m=C(U+"/a/"+y+".gif"),b=R(),E=A(t,r),w=j(x,y),c=h(y,E.getUser()),"object"==typeof n.bootstrap)setTimeout(function(){b.emit(F)},0);else if("string"==typeof n.bootstrap&&"LOCALSTORAGE"===n.bootstrap.toUpperCase()&&"undefined"!=typeof Storage){T=!0;try{I=JSON.parse(localStorage.getItem(c))}catch(s){localStorage.setItem(c,null)}null===I?w.fetchFlagSettings(E.getUser(),S,function(e,t){I=t,t&&localStorage.setItem(c,JSON.stringify(I)),b.emit(F)}):(setTimeout(function(){b.emit(F)},0),w.fetchFlagSettings(E.getUser(),S,function(e,t){t&&localStorage.setItem(c,JSON.stringify(t))}))}else w.fetchFlagSettings(E.getUser(),S,function(e,t){I=t,b.emit(F)});return w.fetchGoals(function(e,t){t&&t.length>0&&(N=t,O=D(N,i))}),"complete"!==document.readyState?window.addEventListener("load",o):o(),window.addEventListener("beforeunload",function(){m.flush(E.getUser(),!0)}),N&&N.length>0&&(window.history&&history.pushState?window.addEventListener("popstate",a):window.addEventListener("hashchange",a)),window.addEventListener("message",g),H}var y,m,w,k,b,S,E,x,U,L,O,T,N,C=n(5),R=n(4),D=n(6),J=n(9),j=n(8),A=n(7),q=n(1),I={},F="ready",G="change",$=2e3,B={},H={identify:a,variation:c,track:u,on:p,off:d,allFlags:s};e.exports={initialize:v},e.exports.version="1.1.9"},function(e,t,n){function r(e){return c.btoa(unescape(encodeURIComponent(e)))}function o(e){return r(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function i(e){return JSON.parse(JSON.stringify(e))}function a(e,t){var n={};if(!e||!t)return{};for(var r in e)e.hasOwnProperty(r)&&t[r]!==e[r]&&(n[r]={previous:e[r],current:t[r]});return n}var c=n(2);e.exports={btoa:r,base64URLEncode:o,clone:i,modifications:a}},function(e,t,n){!function(){function e(e){this.message=e}var n=t,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",n.btoa||(n.btoa=function(t){for(var n,o,i=String(t),a=0,c=r,s="";i.charAt(0|a)||(c="=",a%1);s+=c.charAt(63&n>>8-a%1*8)){if(o=i.charCodeAt(a+=.75),o>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|o}return s}),n.atob||(n.atob=function(t){var n=String(t).replace(/=+$/,"");if(n.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,i,a=0,c=0,s="";i=n.charAt(c++);~i&&(o=a%4?64*o+i:i,a++%4)?s+=String.fromCharCode(255&o>>(-2*a&6)):0)i=r.indexOf(i);return s})}()},function(e,t){"use strict";var n=/[|\\{}()[\]^$+*?.]/g;e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(n,"\\$&")}},function(e,t){function n(){var e={},t={};return e.on=function(e,n,r){t[e]=t[e]||[],t[e]=t[e].concat({handler:n,context:r})},e.off=function(e,n,r){if(t[e])for(var o=0;o<t[e].length;o++)t[e][o].handler===n&&t[e][o].context===r&&(t[e]=t[e].slice(0,o).concat(t[e].slice(o+1)))},e.emit=function(e){if(t[e])for(var n=0;n<t[e].length;n++)t[e][n].handler.apply(t[e][n].context,Array.prototype.slice.call(arguments,1))},e}e.exports=n},function(e,t,n){function r(e){var t={},n=[],r=!0;return t.enqueue=function(e){n.push(e)},t.flush=function(i,a){var c=2e3-e.length,s=[];if(!i)return r&&console&&console.warn&&console.warn("Be sure to call `identify` in the LaunchDarkly client: http://docs.launchdarkly.com/docs/running-an-ab-test#include-the-client-side-snippet"),!1;for(r=!1;c>0&&n.length>0;){var u=n.pop();u.user=i,c-=o.base64URLEncode(JSON.stringify(u)).length,c<0&&s.length>0?n.push(u):s.push(u)}if(s.length>0){var l=e+"?d="+o.base64URLEncode(JSON.stringify(s));if("withCredentials"in new XMLHttpRequest){var f=new XMLHttpRequest;f.open("GET",l,!a),f.send()}else{var p=new Image;p.src=l}}return n.length>0&&(a?t.flush(i,a):setTimeout(function(){t.flush(i)},0)),!1},t}var o=n(1);e.exports=r},function(e,t,n){function r(e,t,n,r){var o,i,c=t.replace(n,"").replace(r,"");switch(e.kind){case"exact":i=t,o=new RegExp("^"+a(e.url)+"/?$");break;case"canonical":i=c,o=new RegExp("^"+a(e.url)+"/?$");break;case"substring":i=c,o=new RegExp(".*"+a(e.substring)+".*$");break;case"regex":i=c,o=new RegExp(e.pattern);break;default:return!1}return o.test(i)}function o(e,t){for(var n=[],r=0;r<t.length;r++)for(var o=e.target,i=t[r],a=i.selector,c=document.querySelectorAll(a);o&&c.length>0;){for(var s=0;s<c.length;s++)o===c[s]&&n.push(i);o=o.parentNode}return n}function i(e,t){for(var n={},e=e,i=null,a=[],c=0;c<e.length;c++)for(var s=e[c],u=s.urls||[],l=0;l<u.length;l++)if(r(u[l],location.href,location.search,location.hash)){"pageview"===s.kind?t("pageview",s):(a.push(s),t("click_pageview",s));break}return a.length>0&&(i=function(e){for(var n=o(e,a),r=0;r<n.length;r++)t("click",n[r])},document.addEventListener("click",i)),n.dispose=function(){document.removeEventListener("click",i)},n}var a=n(3);e.exports=i},function(e,t,n){function r(e){var t=i.clone(e);return t.key&&(t.key=t.key.toString()),t}function o(e,t){var n,o={};return o.setUser=function(e){n=r(e),t(i.clone(n))},o.getUser=function(){return i.clone(n)},e&&o.setUser(e),o}var i=n(1);e.exports=o},function(e,t,n){function r(e,t){var n=new XMLHttpRequest;return n.addEventListener("load",function(){200===n.status&&n.getResponseHeader("Content-type")===s?t(null,JSON.parse(n.responseText)):t(n.statusText)}),n.addEventListener("error",function(){t(n.statusText)}),n.open("GET",e),n.send(),n}function o(e,t){var n={};return n.fetchFlagSettings=function(n,o,s){var u,l=c.base64URLEncode(JSON.stringify(n)),f=[e,"/sdk/eval/",t,"/users/",l,o?"?h="+o:""].join(""),p=function(e){return function(){e.apply(null,arguments),i=null,a=null}}(s);i?(i.abort(),u=function(e){return function(){e&&e.apply(null,arguments),p.apply(null,arguments)}}(a)):u=p,a=u,i=r(f,u)},n.fetchGoals=function(n){var o=[e,"/sdk/goals/",t].join("");r(o,n)},n}var i,a,c=n(1),s="application/json";e.exports=o},function(e,t){function n(e,t){var n={},e=e+"/ping/"+t,r=null;return n.connect=function(t){"undefined"!=typeof EventSource&&(r=new window.EventSource(e),r.addEventListener("ping",t))},n.disconnect=function(){r&&r.close()},n.isConnected=function(){return r&&(r.readyState===EventSource.OPEN||r.readyState===EventSource.CONNECTING)},n}e.exports=n}])});